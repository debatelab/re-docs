
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ensemble generation &#8212; RE Docs  documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/styles/pydata-sphinx-theme.css" type="text/css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="API Documentation" href="../api-docs/api.html" />
    <link rel="prev" title="Introduction of using the package re-python" href="rethon-tutorial.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="../../index.html">
<p class="title">RE Docs</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../tau-docs/index-tau.html">
  Tau Docs
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../index-rethon.html">
  Rethon Docs
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="rethon-tutorials.html">
   Tutorials
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="rethon-tutorial.html">
     Rethon Basics
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Ensemble Generation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../api-docs/api.html">
   API documentation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../api-docs/api-base-core.html">
     Abstract and Core Classes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api-docs/api-numpy-implementation.html">
     Numpy Implementation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api-docs/api-bitarray-implementation.html">
     Bitarray Implementation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api-docs/api-setbased-implementation.html">
     Set Based Implementation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api-docs/api-util.html">
     Utility Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api-docs/api-ensemble-generation.html">
     Ensemble Generation
    </a>
   </li>
  </ul>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Generating-ensembles-with-the-EnsembleGenerator">
   Generating ensembles with the
   <code class="docutils literal notranslate">
    <span class="pre">
     EnsembleGenerator
    </span>
   </code>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Using-json-serialization-to-serialize-the-model-runs">
     Using json serialization to serialize the model runs
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Generating-ensemble-data">
   Generating ensemble data
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Generating-ensemble-data-with-standard-data-items">
     Generating ensemble data with standard data items
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Storing-ensemble-data-as-CSV-files">
     Storing ensemble data as CSV files
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Complex-scenarios-of-creating-new-data-items">
     Complex scenarios of creating new data items
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Ensemble-generation">
<h1>Ensemble generation<a class="headerlink" href="#Ensemble-generation" title="Permalink to this headline">#</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">rethon</span></code> package contains several methods and classes to generate RE ensembles using the different implementations.</p>
<p>There are four classes with the following class hierarchy:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">EnsembleGenerator</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">SimpleEnsembleGenerator</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GlobalREEnsembleGenerator</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LocalREEnsembleGenerator</span></code></p></li>
</ul>
</li>
</ul>
<p><em>Source:</em> You can download this notebook from <a class="reference external" href="https://github.com/debatelab/re-docs/blob/master/source/rethon-docs/tutorials/ensemble-generation-tutorial.ipynb">here</a>.</p>
<div class="section" id="Generating-ensembles-with-the-EnsembleGenerator">
<h2>Generating ensembles with the <code class="docutils literal notranslate"><span class="pre">EnsembleGenerator</span></code><a class="headerlink" href="#Generating-ensembles-with-the-EnsembleGenerator" title="Permalink to this headline">#</a></h2>
<p>The ensemble generator provides different <a class="reference external" href="https://www.w3schools.com/python/python_iterators.asp">iterators</a> and has to be instantiated with</p>
<ul class="simple">
<li><p>a list of dialectical structures in a simplified format (arguments are represented as integer lists),</p></li>
<li><p>the size of the sentence pool,</p></li>
<li><p>a list of initial commitments,</p></li>
<li><p>a list of model-parameters,</p></li>
<li><p>a list of implementations of <code class="docutils literal notranslate"><span class="pre">Position</span></code>, <code class="docutils literal notranslate"><span class="pre">DialecticalStructure</span></code> and <code class="docutils literal notranslate"><span class="pre">ReflectiveEquilibrium</span></code> and</p></li>
<li><p>a switch indicating whether all branches of each model run should be created as well.</p></li>
</ul>
<p>The iterator will loop through the cartesian product of the given model implementations, dialectical structures, different model parameters, initial commitments and, if desired, through all branches.</p>
<p>Let’s take a look at a simple example. The algorithm will take standard model parameters if we do not specify model parameters and it will take a standard implementation if we do not specify implementations. The simple example will use one dialectical structure and two initial commitments:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rethon</span> <span class="kn">import</span> <span class="n">EnsembleGenerator</span>

<span class="c1"># the standard example with a sentence pool n=7</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">arguments</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">]]</span>
<span class="n">dia_structure_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">arguments</span><span class="p">]</span>
<span class="c1"># two initial commitments</span>
<span class="n">init_coms_1</span> <span class="o">=</span> <span class="p">{</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">}</span>
<span class="n">init_coms_2</span> <span class="o">=</span> <span class="p">{</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">}</span>
<span class="n">coms_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">init_coms_1</span><span class="p">,</span> <span class="n">init_coms_2</span><span class="p">]</span>

<span class="n">ensemble_gen</span> <span class="o">=</span> <span class="n">EnsembleGenerator</span><span class="p">(</span><span class="n">arguments_list</span> <span class="o">=</span> <span class="n">dia_structure_list</span><span class="p">,</span>
                                 <span class="n">n_sentence_pool</span> <span class="o">=</span> <span class="n">n</span><span class="p">,</span>
                                 <span class="n">initial_commitments_list</span> <span class="o">=</span> <span class="n">coms_list</span><span class="p">)</span>
<span class="c1"># looping through the ensemble</span>
<span class="k">for</span> <span class="n">model_run</span> <span class="ow">in</span> <span class="n">ensemble_gen</span><span class="o">.</span><span class="n">ensemble_iter</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The model run ended with </span><span class="si">{</span><span class="n">model_run</span><span class="o">.</span><span class="n">state</span><span class="p">()</span><span class="o">.</span><span class="n">last_commitments</span><span class="p">()</span><span class="si">}</span><span class="s2"> as its final commitments.&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;New ensemble with all branches:&quot;</span><span class="p">)</span>
<span class="c1"># running all branches and looping through them:</span>
<span class="n">ensemble_gen</span> <span class="o">=</span> <span class="n">EnsembleGenerator</span><span class="p">(</span><span class="n">arguments_list</span> <span class="o">=</span> <span class="n">dia_structure_list</span><span class="p">,</span>
                                 <span class="n">n_sentence_pool</span> <span class="o">=</span> <span class="n">n</span><span class="p">,</span>
                                 <span class="n">initial_commitments_list</span> <span class="o">=</span> <span class="n">coms_list</span><span class="p">,</span>
                                 <span class="n">create_branches</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">model_run</span> <span class="ow">in</span> <span class="n">ensemble_gen</span><span class="o">.</span><span class="n">ensemble_iter</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The model run ended with </span><span class="si">{</span><span class="n">model_run</span><span class="o">.</span><span class="n">state</span><span class="p">()</span><span class="o">.</span><span class="n">last_commitments</span><span class="p">()</span><span class="si">}</span><span class="s2"> as its final commitments.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The model run ended with {1, 3, 4, 5, -6, -2} as its final commitments.
The model run ended with {1, 3, 4, 5, -6, -2} as its final commitments.
New ensemble with all branches:
The model run ended with {1, 3, 4, 5, -6, -2} as its final commitments.
The model run ended with {2, 5, 6, 7, -4, -1} as its final commitments.
The model run ended with {1, 3, 4, 5, -6, -2} as its final commitments.
</pre></div></div>
</div>
<p>The module provides several helper methods to produce random arguments, initial commitments and a variation of model parameters that can be used to generate more complex ensembles:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rethon</span> <span class="kn">import</span> <span class="n">EnsembleGenerator</span>
<span class="kn">from</span> <span class="nn">tau.util</span> <span class="kn">import</span> <span class="n">create_random_argument_list</span><span class="p">,</span> <span class="n">random_position_as_set</span><span class="p">,</span> <span class="n">create_random_arguments</span>
<span class="kn">from</span> <span class="nn">rethon.util</span> <span class="kn">import</span> <span class="n">standard_model_params_varied_alphas</span>

<span class="c1"># Sentence pool</span>
<span class="n">n</span><span class="o">=</span><span class="mi">6</span>
<span class="c1"># Two implementations:</span>
<span class="n">implementations</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;tau_module_name&#39;</span><span class="p">:</span> <span class="s1">&#39;tau&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;position_class_name&#39;</span><span class="p">:</span><span class="s1">&#39;StandardPosition&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;dialectical_structure_class_name&#39;</span><span class="p">:</span> <span class="s1">&#39;DAGDialecticalStructure&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;rethon_module_name&#39;</span><span class="p">:</span> <span class="s1">&#39;rethon&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;reflective_equilibrium_class_name&#39;</span><span class="p">:</span> <span class="s1">&#39;StandardGlobalReflectiveEquilibrium&#39;</span><span class="p">},</span>
                   <span class="p">{</span><span class="s1">&#39;tau_module_name&#39;</span><span class="p">:</span> <span class="s1">&#39;tau&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;position_class_name&#39;</span><span class="p">:</span><span class="s1">&#39;SetBasedPosition&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;dialectical_structure_class_name&#39;</span><span class="p">:</span> <span class="s1">&#39;DAGSetBasedDialecticalStructure&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;rethon_module_name&#39;</span><span class="p">:</span> <span class="s1">&#39;rethon&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;reflective_equilibrium_class_name&#39;</span><span class="p">:</span> <span class="s1">&#39;GlobalSetBasedReflectiveEquilibrium&#39;</span>
                    <span class="p">}]</span>

<span class="c1"># Two random dialectical structures with 7 arguments each</span>
<span class="n">n_dialectical_structures</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">arguments_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">create_random_arguments</span><span class="p">(</span><span class="n">n_sentences</span><span class="o">=</span><span class="n">n</span><span class="p">,</span>
                                          <span class="n">n_arguments</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                                          <span class="n">n_max_premises</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_dialectical_structures</span><span class="p">)]</span>

<span class="c1"># Standard model parameters with varied alpha weights</span>
<span class="n">model_parameters_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">standard_model_params_varied_alphas</span><span class="p">(</span><span class="n">alpha_resolution</span> <span class="o">=</span><span class="mi">3</span><span class="p">))</span>

<span class="c1"># Two random initial commitments</span>
<span class="n">n_positions</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">coms_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">random_position_as_set</span><span class="p">(</span><span class="n">n_sentences</span> <span class="o">=</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_positions</span><span class="p">)]</span>


<span class="n">ensemble_gen</span> <span class="o">=</span> <span class="n">EnsembleGenerator</span><span class="p">(</span><span class="n">arguments_list</span> <span class="o">=</span> <span class="n">arguments_list</span><span class="p">,</span>
                                 <span class="n">n_sentence_pool</span> <span class="o">=</span> <span class="n">n</span><span class="p">,</span>
                                 <span class="n">initial_commitments_list</span> <span class="o">=</span> <span class="n">coms_list</span><span class="p">,</span>
                                 <span class="n">model_parameters_list</span> <span class="o">=</span> <span class="n">model_parameters_list</span><span class="p">,</span>
                                 <span class="n">implementations</span> <span class="o">=</span> <span class="n">implementations</span><span class="p">)</span>

<span class="n">model_runs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ensemble_gen</span><span class="o">.</span><span class="n">ensemble_iter</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generated </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">model_runs</span><span class="p">)</span><span class="si">}</span><span class="s2"> ensembles.&quot;</span><span class="p">)</span>
<span class="c1"># looping through the ensemble</span>
<span class="k">for</span> <span class="n">model_run</span> <span class="ow">in</span> <span class="n">model_runs</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The model run ended with </span><span class="si">{</span><span class="n">model_run</span><span class="o">.</span><span class="n">state</span><span class="p">()</span><span class="o">.</span><span class="n">last_commitments</span><span class="p">()</span><span class="si">}</span><span class="s2"> as its final commitments.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generated 24 ensembles.
The model run ended with {1, 2, 3, 5, -6, -4} as its final commitments.
The model run ended with {-1, -6, -5, -4, -3, -2} as its final commitments.
The model run ended with {1, 3, 5, -6, -4} as its final commitments.
The model run ended with {-1, -6, -5, -4, -3, -2} as its final commitments.
The model run ended with {1, 3, 5, -6, -4} as its final commitments.
The model run ended with {4, -1, -6, -5, -3, -2} as its final commitments.
The model run ended with {2, 3, 4, 5, -6} as its final commitments.
The model run ended with {6, -5, -4, -3, -2} as its final commitments.
The model run ended with {3, -6, 2} as its final commitments.
The model run ended with {6, -5, -4, -3, -2} as its final commitments.
The model run ended with {3, -6, 2, -5} as its final commitments.
The model run ended with {3, -6, -5, -4, -2} as its final commitments.
The model run ended with {1, 2, 3, 5, -6, -4} as its final commitments.
The model run ended with {-1, -6, -5, -4, -3, -2} as its final commitments.
The model run ended with {1, 3, 5, -6, -4} as its final commitments.
The model run ended with {-1, -6, -5, -4, -3, -2} as its final commitments.
The model run ended with {1, 3, 5, -6, -4} as its final commitments.
The model run ended with {4, -2, -6, -5, -3, -1} as its final commitments.
The model run ended with {2, 3, 4, 5, -6} as its final commitments.
The model run ended with {6, -5, -4, -3, -2} as its final commitments.
The model run ended with {-6, 2, 5} as its final commitments.
The model run ended with {3, -6, -5, -4, -2} as its final commitments.
The model run ended with {-6, 2, 3, -5} as its final commitments.
The model run ended with {3, -6, -5, -4, -2} as its final commitments.
</pre></div></div>
</div>
<div class="section" id="Using-json-serialization-to-serialize-the-model-runs">
<h3>Using json serialization to serialize the model runs<a class="headerlink" href="#Using-json-serialization-to-serialize-the-model-runs" title="Permalink to this headline">#</a></h3>
<p>By using the module <code class="docutils literal notranslate"><span class="pre">rethon.util</span></code> you can serialize the resulting model runs in the json format—for instance, in the following way:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rethon.util</span> <span class="kn">import</span> <span class="n">rethon_dump</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">getcwd</span><span class="p">,</span> <span class="n">path</span>

<span class="c1"># serializing the ensemble JSON into a file</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;ensemble_as_json.json&#39;</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">output_file</span><span class="p">:</span>
    <span class="n">rethon_dump</span><span class="p">({</span><span class="s1">&#39;ensemble&#39;</span><span class="p">:</span> <span class="n">model_runs</span><span class="p">},</span> <span class="n">output_file</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Generating-ensemble-data">
<h2>Generating ensemble data<a class="headerlink" href="#Generating-ensemble-data" title="Permalink to this headline">#</a></h2>
<p>The method <code class="docutils literal notranslate"><span class="pre">ensemble_items_iter</span></code> can be used to generate data of your ensembles by <strong>defining data items</strong> that are generated for each model run. The method <code class="docutils literal notranslate"><span class="pre">ensemble_items_iter</span></code> will return a dictionary with these data items for each model run.</p>
<p>Data items can be defined by using the <code class="docutils literal notranslate"><span class="pre">add_item</span></code> method of <code class="docutils literal notranslate"><span class="pre">EnsembleGenerator</span></code>. The function expects a key for the data item and a function with <code class="docutils literal notranslate"><span class="pre">EnsembleGenerator</span></code> as one argument. The idea: The ensemble generator will call this function to generate the data item for each model run. The ensemble generator provides several methods that you can use to define a particular data item.</p>
<p>Let’s have a look at a simple example: We want to define a data item that stores the last commitments:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rethon</span> <span class="kn">import</span> <span class="n">EnsembleGenerator</span>

<span class="c1"># our standard example with a sentence pool n=7</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">arguments</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">]]</span>
<span class="n">dia_structure_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">arguments</span><span class="p">]</span>
<span class="n">init_coms_1</span> <span class="o">=</span> <span class="p">{</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">}</span>
<span class="n">init_coms_2</span> <span class="o">=</span> <span class="p">{</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">}</span>
<span class="n">coms_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">init_coms_1</span><span class="p">,</span> <span class="n">init_coms_2</span><span class="p">]</span>

<span class="n">ensemble_gen</span> <span class="o">=</span> <span class="n">EnsembleGenerator</span><span class="p">(</span><span class="n">arguments_list</span> <span class="o">=</span> <span class="n">dia_structure_list</span><span class="p">,</span>
                                 <span class="n">n_sentence_pool</span> <span class="o">=</span> <span class="n">n</span><span class="p">,</span>
                                 <span class="n">initial_commitments_list</span> <span class="o">=</span> <span class="n">coms_list</span><span class="p">)</span>

<span class="c1"># defining the function</span>
<span class="k">def</span> <span class="nf">data_last_coms</span><span class="p">(</span><span class="n">ensemble_generator</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">ensemble_generator</span><span class="o">.</span><span class="n">state</span><span class="p">()</span><span class="o">.</span><span class="n">last_commitments</span><span class="p">()</span>
<span class="c1"># adding the data item</span>
<span class="n">ensemble_gen</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="s1">&#39;last_coms&#39;</span><span class="p">,</span> <span class="n">data_last_coms</span><span class="p">)</span>

<span class="c1"># looping through the ensemble using the item_iter</span>
<span class="k">for</span> <span class="n">model_run_data_items</span> <span class="ow">in</span> <span class="n">ensemble_gen</span><span class="o">.</span><span class="n">ensemble_items_iter</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The model run produced the following data items:  </span><span class="si">{</span><span class="n">model_run_data_items</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The model run produced the following data items:  {&#39;last_coms&#39;: {1, 3, 4, 5, -6, -2}}.
The model run produced the following data items:  {&#39;last_coms&#39;: {2, 5, 6, 7, -4, -1}}.
</pre></div></div>
</div>
<p>You can use ananymous functions to add data fields in a compact way:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># adding the data item</span>
<span class="n">ensemble_gen</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="s1">&#39;last_theory&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">state</span><span class="p">()</span><span class="o">.</span><span class="n">last_theory</span><span class="p">())</span>

<span class="c1"># looping through the ensemble using the item_iter</span>
<span class="k">for</span> <span class="n">model_run_data_items</span> <span class="ow">in</span> <span class="n">ensemble_gen</span><span class="o">.</span><span class="n">ensemble_items_iter</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The model run produced the following data items:  </span><span class="si">{</span><span class="n">model_run_data_items</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The model run produced the following data items:  {&#39;last_coms&#39;: {1, 3, 4, 5, -6, -2}, &#39;last_theory&#39;: {1}}.
The model run produced the following data items:  {&#39;last_coms&#39;: {1, 3, 4, 5, -6, -2}, &#39;last_theory&#39;: {1}}.
</pre></div></div>
</div>
<p>In a similar way, you have access to the RE instance itself and the dialectical structure of each model run. Refer to the <a class="reference external" href="https://debatelab.github.io/re-docs/api-docs/api-ensemble-generation.html#ensemblegenerator">api docs</a> for more information.</p>
<div class="section" id="Generating-ensemble-data-with-standard-data-items">
<h3>Generating ensemble data with standard data items<a class="headerlink" href="#Generating-ensemble-data-with-standard-data-items" title="Permalink to this headline">#</a></h3>
<p>The classes <code class="docutils literal notranslate"><span class="pre">SimpleEnsembleGenerator</span></code>, <code class="docutils literal notranslate"><span class="pre">GlobalREEnsembleGenerator</span></code>, <code class="docutils literal notranslate"><span class="pre">LocalREEnsembleGenerator</span></code> have already a bunch of predefined data fields that can be extended by additional data items if you need them. (For details refer to the <a class="reference external" href="https://debatelab.github.io/re-docs/api-docs/api-ensemble-generation.html">api-docs</a>. [LINK NEEDS UPDATE])</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SimpleEnsembleGenerator</span></code>: Defines data fields that should work well with every implementation. Depending on whether branches are created, the generator will add fields for all fixed points for each model run.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GlobalREEnsembleGenerator</span></code>: Extends <code class="docutils literal notranslate"><span class="pre">SimpleEnsembleGenerator</span></code> with additional data items that are available for globally searching RE processes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LocalREEnsembleGenerator</span></code>: Extends <code class="docutils literal notranslate"><span class="pre">SimpleEnsembleGenerator</span></code> with additional data items that are available for locally searching RE processes.</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rethon</span> <span class="kn">import</span> <span class="n">SimpleEnsembleGenerator</span>

<span class="n">ensemble_gen</span> <span class="o">=</span> <span class="n">SimpleEnsembleGenerator</span><span class="p">(</span><span class="n">arguments_list</span> <span class="o">=</span> <span class="n">dia_structure_list</span><span class="p">,</span>
                                 <span class="n">n_sentence_pool</span> <span class="o">=</span> <span class="n">n</span><span class="p">,</span>
                                 <span class="n">initial_commitments_list</span> <span class="o">=</span> <span class="n">coms_list</span><span class="p">)</span>
<span class="c1"># looping through the ensemble using the item_iter</span>
<span class="k">for</span> <span class="n">model_run_data_items</span> <span class="ow">in</span> <span class="n">ensemble_gen</span><span class="o">.</span><span class="n">ensemble_items_iter</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The model run produced the following data items:  </span><span class="si">{</span><span class="n">model_run_data_items</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The model run produced the following data items:  {&#39;model_name&#39;: &#39;GlobalNumpyReflectiveEquilibrium&#39;, &#39;ds&#39;: [[1, 3], [1, 4], [1, 5], [1, -6], [2, -4], [2, 5], [2, 6], [2, 7]], &#39;n_sentence_pool&#39;: 7, &#39;ds_arg_size&#39;: 8, &#39;ds_infer_dens&#39;: 0.26143928550824114, &#39;ds_n_consistent_complete_positions&#39;: 36, &#39;ds_mean_prem&#39;: 2, &#39;ds_variance_prem&#39;: 0, &#39;tau_truths&#39;: set(), &#39;principles&#39;: [(1, 4), (2, 4)], &#39;account_penalties&#39;: [0.0, 0.3, 1.0, 1.0], &#39;faithfulness_penalties&#39;: [0.0, 0.0, 1.0, 1.0], &#39;weight_account&#39;: 0.35, &#39;weight_systematicity&#39;: 0.55, &#39;weight_faithfulness&#39;: 0.1, &#39;init_coms&#39;: {3, 4, 5}, &#39;init_coms_size&#39;: 3, &#39;init_coms_n_tau_truths&#39;: 0, &#39;init_coms_n_tau_falsehoods&#39;: 0, &#39;init_coms_n_consistent_complete_positions&#39;: 6, &#39;init_coms_dia_consistent&#39;: True, &#39;init_coms_closed&#39;: False, &#39;fixed_point_coms&#39;: {1, 3, 4, 5, -6, -2}, &#39;fixed_point_coms_size&#39;: 6, &#39;fixed_point_coms_n_tau_truths&#39;: 0, &#39;fixed_point_coms_n_tau_falsehoods&#39;: 0, &#39;fixed_point_coms_closed&#39;: True, &#39;fixed_point_coms_consistent&#39;: True, &#39;fixed_point_coms_n_consistent_complete_positions&#39;: 2, &#39;fixed_point_theory&#39;: {1}, &#39;fixed_point_theory_closure&#39;: {1, 3, 4, 5, -6, -2}, &#39;init_coms_min_ax_bases&#39;: [{3, 4, 5}], &#39;n_init_coms_min_ax_base&#39;: 3, &#39;achievements_evolution&#39;: [0, 0.9942142852544784, 1.0, 1.0, 1.0, 1.0], &#39;fixed_point_dia_consistent&#39;: True, &#39;init_final_coms_simple_hamming&#39;: 3, &#39;init_final_coms_hamming&#39;: 3, &#39;init_final_coms_contradictions&#39;: 0, &#39;init_final_coms_expansions&#39;: 3, &#39;init_final_coms_contractions&#39;: 0, &#39;init_final_coms_identities&#39;: 4, &#39;random_choices&#39;: [], &#39;n_random_choices&#39;: 0, &#39;coms_evolution&#39;: [{3, 4, 5}, {1, 3, 4, 5, -6, -2}, {1, 3, 4, 5, -6, -2}], &#39;theory_evolution&#39;: [{1}, {1}, {1}], &#39;process_length&#39;: 6}.
The model run produced the following data items:  {&#39;model_name&#39;: &#39;GlobalNumpyReflectiveEquilibrium&#39;, &#39;ds&#39;: [[1, 3], [1, 4], [1, 5], [1, -6], [2, -4], [2, 5], [2, 6], [2, 7]], &#39;n_sentence_pool&#39;: 7, &#39;ds_arg_size&#39;: 8, &#39;ds_infer_dens&#39;: 0.26143928550824114, &#39;ds_n_consistent_complete_positions&#39;: 36, &#39;ds_mean_prem&#39;: 2, &#39;ds_variance_prem&#39;: 0, &#39;tau_truths&#39;: set(), &#39;principles&#39;: [(1, 4), (2, 4)], &#39;account_penalties&#39;: [0.0, 0.3, 1.0, 1.0], &#39;faithfulness_penalties&#39;: [0.0, 0.0, 1.0, 1.0], &#39;weight_account&#39;: 0.35, &#39;weight_systematicity&#39;: 0.55, &#39;weight_faithfulness&#39;: 0.1, &#39;init_coms&#39;: {3, 4, 5, 6, 7}, &#39;init_coms_size&#39;: 5, &#39;init_coms_n_tau_truths&#39;: 0, &#39;init_coms_n_tau_falsehoods&#39;: 0, &#39;init_coms_n_consistent_complete_positions&#39;: 1, &#39;init_coms_dia_consistent&#39;: True, &#39;init_coms_closed&#39;: False, &#39;fixed_point_coms&#39;: {2, 5, 6, 7, -4, -1}, &#39;fixed_point_coms_size&#39;: 6, &#39;fixed_point_coms_n_tau_truths&#39;: 0, &#39;fixed_point_coms_n_tau_falsehoods&#39;: 0, &#39;fixed_point_coms_closed&#39;: True, &#39;fixed_point_coms_consistent&#39;: True, &#39;fixed_point_coms_n_consistent_complete_positions&#39;: 2, &#39;fixed_point_theory&#39;: {2}, &#39;fixed_point_theory_closure&#39;: {2, 5, 6, 7, -4, -1}, &#39;init_coms_min_ax_bases&#39;: [{3, 4, 5, 6, 7}], &#39;n_init_coms_min_ax_base&#39;: 5, &#39;achievements_evolution&#39;: [0, 0.9704897953734105, 0.986734693877551, 0.9908163265306122, 0.9918367346938776, 0.9918367346938776, 0.9918367346938776, 0.9918367346938776], &#39;fixed_point_dia_consistent&#39;: True, &#39;init_final_coms_simple_hamming&#39;: 5, &#39;init_final_coms_hamming&#39;: 4, &#39;init_final_coms_contradictions&#39;: 1, &#39;init_final_coms_expansions&#39;: 2, &#39;init_final_coms_contractions&#39;: 1, &#39;init_final_coms_identities&#39;: 3, &#39;random_choices&#39;: [1], &#39;n_random_choices&#39;: 1, &#39;coms_evolution&#39;: [{3, 4, 5, 6, 7}, {2, 3, 5, 6, 7, -4, -1}, {2, 5, 6, 7, -4, -1}, {2, 5, 6, 7, -4, -1}], &#39;theory_evolution&#39;: [{2, 3}, {2}, {2}, {2}], &#39;process_length&#39;: 8}.
</pre></div></div>
</div>
</div>
<div class="section" id="Storing-ensemble-data-as-CSV-files">
<h3>Storing ensemble data as CSV files<a class="headerlink" href="#Storing-ensemble-data-as-CSV-files" title="Permalink to this headline">#</a></h3>
<p>You can save the created data to csv files to analyse them later (e.g. by using <a class="reference external" href="https://pandas.pydata.org/docs/index.html">pandas</a>):</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">getcwd</span>

<span class="n">ensemble_gen</span><span class="o">.</span><span class="n">ensemble_items_to_csv</span><span class="p">(</span>
                              <span class="n">output_file_name</span> <span class="o">=</span> <span class="s1">&#39;data_output.csv&#39;</span><span class="p">,</span>
                              <span class="n">output_dir_name</span> <span class="o">=</span> <span class="n">getcwd</span><span class="p">(),</span>
                              <span class="n">archive</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="c1"># save the csv as archived tar.gz</span>
                              <span class="n">save_preliminary_results</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="c1"># will create preliminary csv-data sets</span>
                              <span class="n">preliminary_results_interval</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Complex-scenarios-of-creating-new-data-items">
<h3>Complex scenarios of creating new data items<a class="headerlink" href="#Complex-scenarios-of-creating-new-data-items" title="Permalink to this headline">#</a></h3>
<p>The ensemble generator provides additional functionalities for defining data items. In particular, you can store objects in the generator that can be reused in the definition of your data items. If you have resource-intensive operations you might prefer to reuse calculated data.</p>
<p><em>Consider the following example:</em> The algorithm will loop through all provided dialectical structures, initial conditions and model-parameter sets. If you define a data item that will calculate data on the dialectical structure alone, this data will be re-calculated for a particular dialectical structure for every model run that is based on that dialectical structure. In the case that you have 50 initial commitments and 50 different model-parameter sets, the same data is being calculated 2500
times.</p>
<p>Instead, you can calculate this data once for every dialectical structure, store it in the ensemble generator object and use this data in the definition of the data item. You can do this by simply overwriting a function of <code class="docutils literal notranslate"><span class="pre">EnsembleGenerator</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rethon</span> <span class="kn">import</span> <span class="n">EnsembleGenerator</span>

<span class="k">class</span> <span class="nc">StoreNArgsEnsembleGenerator</span><span class="p">(</span><span class="n">EnsembleGenerator</span><span class="p">):</span>

    <span class="c1"># overwriting the method that initializes storing objects based on dialectical structures</span>
    <span class="k">def</span> <span class="nf">init_tau_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dialectical_structure</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">init_tau_fields</span><span class="p">(</span><span class="n">dialectical_structure</span><span class="p">)</span>
        <span class="c1"># add the number of arguments as an object to the ensemble generator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_obj</span><span class="p">(</span><span class="s1">&#39;ds_number_of_args&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dialectical_structure</span><span class="o">.</span><span class="n">get_arguments</span><span class="p">()))</span>

<span class="c1"># the standard example with a sentence pool n=7</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">arguments</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">]]</span>
<span class="n">dia_structure_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">arguments</span><span class="p">]</span>
<span class="n">init_coms_1</span> <span class="o">=</span> <span class="p">{</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">}</span>
<span class="n">init_coms_2</span> <span class="o">=</span> <span class="p">{</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">}</span>
<span class="n">coms_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">init_coms_1</span><span class="p">,</span> <span class="n">init_coms_2</span><span class="p">]</span>

<span class="c1"># using the new class</span>
<span class="n">ensemble_gen</span> <span class="o">=</span> <span class="n">StoreNArgsEnsembleGenerator</span><span class="p">(</span><span class="n">arguments_list</span> <span class="o">=</span> <span class="n">dia_structure_list</span><span class="p">,</span>
                                           <span class="n">n_sentence_pool</span> <span class="o">=</span> <span class="n">n</span><span class="p">,</span>
                                           <span class="n">initial_commitments_list</span> <span class="o">=</span> <span class="n">coms_list</span><span class="p">)</span>

<span class="c1"># adding the number of arguments as data item by accessing the stored object</span>
<span class="n">ensemble_gen</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="s1">&#39;ds_number_of_args&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;ds_number_of_args&#39;</span><span class="p">))</span>

<span class="c1"># looping through the ensemble using the item_iter</span>
<span class="k">for</span> <span class="n">model_run_data_items</span> <span class="ow">in</span> <span class="n">ensemble_gen</span><span class="o">.</span><span class="n">ensemble_items_iter</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The model run produced the following data items:  </span><span class="si">{</span><span class="n">model_run_data_items</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The model run produced the following data items:  {&#39;ds_number_of_args&#39;: 8}.
The model run produced the following data items:  {&#39;ds_number_of_args&#39;: 8}.
</pre></div></div>
</div>
<p>In a similar way you can overwrite the following methods:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">init_re_start_fields</span></code>: Data items that are calculated based on the dialectical structure and the initial commitments alone.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">init_re_final_fields</span></code>: Data items that are calculated based on the dialectical structure and the resulting re process (including the evolution of the process).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">init_ensemble_fields</span></code>: Data items that are calculated based on the dialectical structure and the resulting re process with all its branches (works only if branching is switched on).</p></li>
</ul>
</div>
</div>
</div>


              </div>
              
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2023, Claus Beisbart, Gregor Betz, Georg Brun, Sebastian Cacean, Andreas Freivogel, Richard Lohse.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.4.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>